function getUTMParams(){const t=new URLSearchParams(window.location.search);return{utm_source:t.get("utm_source")||"direct",utm_medium:t.get("utm_medium")||"none",utm_campaign:t.get("utm_campaign")||"none",utm_content:t.get("utm_content")||"none",utm_term:t.get("utm_term")||"none"}}function pushToDataLayer(t,e={}){window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:t,...e})}function initCTATracking(){const t=document.querySelectorAll("[data-cta]"),e=getUTMParams();t.forEach(t=>{t.addEventListener("click",function(t){const n=this.getAttribute("data-cta");pushToDataLayer("cta_click",{cta_location:n,cta_text:this.textContent.trim(),...e}),pushToDataLayer("telegram_redirect",{cta_location:n,...e});const a=this.getAttribute("href");try{const n=new URL(a);n.searchParams.set("startapp",`utm_${e.utm_source}_${e.utm_content}`),t.preventDefault(),setTimeout(()=>{window.location.href=n.toString()},150)}catch(t){console.error("Error constructing Telegram URL",t)}})})}function initStickyCTA(){const t=document.getElementById("sticky-cta"),e=document.getElementById("hero");if(!t||!e)return;new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting?t.classList.add("translate-y-full"):t.classList.remove("translate-y-full")})},{threshold:.1}).observe(e)}function initScrollTracking(){const t=[25,50,75,100],e=new Set;window.addEventListener("scroll",()=>{const n=Math.round(window.scrollY/(document.documentElement.scrollHeight-window.innerHeight)*100);t.forEach(t=>{n>=t&&!e.has(t)&&(e.add(t),pushToDataLayer("scroll_depth",{depth_percent:t}))})},{passive:!0})}function initTimeTracking(){[10,30,60,120].forEach(t=>{setTimeout(()=>{pushToDataLayer("time_on_page",{time_seconds:t})},1e3*t)})}document.addEventListener("DOMContentLoaded",()=>{const t=getUTMParams();pushToDataLayer("page_view_custom",{page_title:document.title,page_location:window.location.href,market:"sea",language:"en",...t}),initCTATracking(),initStickyCTA(),initScrollTracking(),initTimeTracking()});